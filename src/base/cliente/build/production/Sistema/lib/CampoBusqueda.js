function CampoBusqueda(){this.me=this;this.EsModal=true;this.EsMazimizable=false;this.EsMaximizado=false;this.ClaseModelo;this.ClaseListado;this.ClaseFormulario;this.UrlBusqueda;this.FuncionLecturaPorId="BuscarPorId";this.btnVer="";this.btnBuscar="";this.btnLimpiar="";this.tbCodigo="";this.Controller=null;this.FuncionLecturaPorCodigo="BuscarPorCodigo";this.itemId=0;this.GetFiltrosPreseleccionados=function(){return null};this.parametrosAdicionales=[];this.SetModal=function(a){this.EsModal=a};this.SetMaximizado=function(a){this.EsMaximizado=a};this.SetMaximizable=function(a){this.EsMaximizable=a};this.SetClaseModelo=function(a){this.ClaseModelo=a};this.SetFuncionLecturaPorId=function(a){this.FuncionLecturaPorId=a};this.SetFuncionLecturaPorCodigo=function(a){this.FuncionLecturaPorCodigo=a};this.SetClaseListado=function(a){this.ClaseListado=a};this.SetClaseFormulario=function(a){this.ClaseFormulario=a};this.SetUrlBusqueda=function(a){this.UrlBusqueda=a};this.SetController=function(a){this.Controller=a};this.SetFiltroListado=function(a){this.GetFiltrosPreseleccionados=a};this.AgregarParametroAdicional=function(b,a){this.parametrosAdicionales[this.parametrosAdicionales.length]={nombre:b,valor:a}};this.Deshabilitar=function(){if(this.btnVer!=""&&this.Controller!=null){this.Controller.getView().down("button[name='"+this.btnVer+"']").disable()}if(this.btnBuscar!=""&&this.Controller!=null){this.Controller.getView().down("button[name='"+this.btnBuscar+"']").disable()}if(this.tbCodigo!=""&&this.Controller!=null){this.Controller.getView().down("textfield[name='"+this.tbCodigo+"']").setValue("");this.Controller.getView().down("textfield[name='"+this.tbCodigo+"']").disable()}if(this.btnLimpiar!=""&&this.Controller!=null){this.Controller.getView().down("button[name='"+this.btnLimpiar+"']").disable()}};this.Habilitar=function(){if(this.btnVer!=""&&this.Controller!=null){this.Controller.getView().down("button[name='"+this.btnVer+"']").enable()}if(this.btnBuscar!=""&&this.Controller!=null){this.Controller.getView().down("button[name='"+this.btnBuscar+"']").enable()}if(this.tbCodigo!=""&&this.Controller!=null){this.Controller.getView().down("textfield[name='"+this.tbCodigo+"']").enable()}if(this.btnLimpiar!=""&&this.Controller!=null){this.Controller.getView().down("button[name='"+this.btnLimpiar+"']").enable()}};this.SetReadOnly=function(){if(this.btnBuscar!=""&&this.Controller!=null){this.Controller.getView().down("button[name='"+this.btnBuscar+"']").disable()}if(this.tbCodigo!=""&&this.Controller!=null){this.Controller.getView().down("textfield[name='"+this.tbCodigo+"']").disable()}};this.SetBtnVerRegistro=function(b){var a=this.Controller.getView().down("button[name='"+b+"']");this.btnVer=b;a.on("click",this.onBtnVerClick,this)};this.SetBtnLimpiar=function(b){var a=this.Controller.getView().down("button[name='"+b+"']");this.btnLimpiar=b;a.on("click",this.onBtnLimpiar,this)};this.SetTextFieldCodigo=function(a){var b=this.Controller.getView().down("textfield[name='"+a+"']");this.tbCodigo=a;b.on("specialkey",this.onTbCodigoSpecialKey,this);b.on("change",this.Controller.tbChangeToUpperCase,this.Controller)};this.SetBtnBuscar=function(b){var a=this.Controller.getView().down("button[name='"+b+"']");this.btnBuscar=b;a.on("click",this.onBtnBuscarClick,this)};this.CargarComponente=function(a){if(a!=undefined){a.get=function(b){return this[b]};this.onRegistroSeleccionadoOk(a,true)}};this.Limpiar=function(){this.itemId=0;this.onRegistroSeleccionadoError()};this.BuscarPorId=function(b,a){if(a==true){this.SetReadOnly()}this.BuscarPorFuncion(b,this.FuncionLecturaPorId)};this.BuscarPorCodigo=function(a){if(a==""){this.RegistroSeleccionadoError()}else{this.BuscarPorFuncion(a,this.FuncionLecturaPorCodigo)}};this.AbrirVentanaBusqueda=function(){var c=Ext.create(this.ClaseListado,{});var b=this,a,d;c.paramsEntrada=ManejadorDeVentanas.ReqListadoWS(this.EsMaximizable,this.EsMaximizado,null,ModoEjecucionListado.SeleccionIndividual,true,true,this.GetFiltrosPreseleccionados());a=c.getController().GetComponenteFoco();d=Ext.create("Ext.window.Window",{title:"Seleccionar Elemento",height:c.controller.params.altoVentana,width:c.controller.params.anchoVentana,modal:this.EsModal,maximizable:this.EsMaximizable,maximized:this.Maximizado,collapsible:false,resizable:true,layout:"fit",defaultFocus:a,listeners:{close:function(){b.ProcesarRespuesta(c.datosRetorno)}}});d.add(c);d.show()};this.AbrirVentanaFormulario=function(){var a=this;var b={ObjetoContenedor:a,AlCerrarVentanaFormulario:function(){a.BuscarPorId(a.itemId)}};if(this.itemId!=0){ManejadorDeVentanas.AbrirFormularioEdicion(this.ClaseFormulario,this.itemId,true,b)}};this.ProcesarRespuesta=function(a){if(a.itemsSeleccionados.length>0){this.BuscarPorFuncion(a.itemsSeleccionados[0].get("id"),this.FuncionLecturaPorId)}};this.BuscarPorFuncion=function(f,j){var g;var e=this;var a={};var c,d;var b;var h;if(f){g=Ext.create("Ext.data.Store",{model:e.ClaseModelo,proxy:{type:"ajax",url:e.UrlBusqueda,reader:{type:"json",rootProperty:"root",messageProperty:"message"}},autoLoad:false});a.codigo=f;a.f=j;for(d=0;d<this.parametrosAdicionales.length;d++){b=this.parametrosAdicionales[d].nombre;h=this.parametrosAdicionales[d].valor;a[b]=h}g.load({params:a,callback:function(l,k,i){if(i){e.onRegistroSeleccionadoOk(g.first(),false)}else{c=e.RegistroSeleccionadoError();if(c==null){var m=Ext.decode(k.getResponse().responseText);Ext.Msg.alert("Error",m.message)}}}})}};this.onBtnBuscarClick=function(){this.AbrirVentanaBusqueda()},this.onTbCodigoSpecialKey=function(a,b){if(b.getKey()==b.ENTER||b.getKey()==b.TAB){this.BuscarPorCodigo(a.value)}};this.onBtnVerClick=function(){this.AbrirVentanaFormulario()};this.onBtnLimpiar=function(){this.itemId=0;this.onRegistroSeleccionadoError()};this.RegistroSeleccionadoError=function(){this.itemId=0;return this.onRegistroSeleccionadoError()};this.onRegistroSeleccionadoOk=function(b,a){console.log("Error metodo no implementado: onRegistroSeleccionadoOk ()")};this.onRegistroSeleccionadoError=function(){this.itemId=0;return null}};