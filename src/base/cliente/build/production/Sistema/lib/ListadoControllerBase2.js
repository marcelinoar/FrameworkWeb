var ListadoControllerBase2={InyectarDependencia:function(a,b){Ext.apply(a,{permisos:null,store_params:{},ctl:{},filtros:{},params:null});Ext.apply(a.getView(),{paramsEntrada:{modoEjecucion:null,verColEditar:null,verColBorrar:null},datosRetorno:{itemsSeleccionados:[]}});a.permisos=sesionUsuario.GetPermiso(b);ControllerBase.InyectarDependencia(a);a.filtros=new Array();a.onBtnLimpiarFiltrosClick=this.onBtnLimpiarFiltrosClick;a.onBtnAceptarClick=this.onBtnAceptarClick;a.onBtnCancelarClick=this.onBtnCancelarClick;a.onRender=this.onRender;a.onBtnBuscarClick=this.onBtnBuscarClick;a.onEditarRegistroGrilla=this.onEditarRegistroGrilla;a.onBorrarRegistroGrilla=this.onBorrarRegistroGrilla;a.onBtnRecargarListadoClick=this.onBtnRecargarListadoClick;a.onBtnNuevoClick=this.onBtnNuevoClick;a.onListadoGrillaCellDblClick=this.onListadoGrillaCellDblClick;a.AgregarItemsSeleccionados=this.AgregarItemsSeleccionados;a.ConfigurarModoVista=this.ConfigurarModoVista;a.ConfigurarModoSeleccion=this.ConfigurarModoSeleccion;a.ConfigurarModoSeleccionIndividual=this.ConfigurarModoSeleccionIndividual;a.RefrescarGrilla=this.RefrescarGrilla;a.RefrescarFiltros=this.RefrescarFiltros;a.ConfigurarPantalla=this.ConfigurarPantalla;a.SetDatoSalida=this.SetDatoSalida;a.IntentarCerrarVentanaContenedora=this.IntentarCerrarVentanaContenedora;a.GetComponenteFoco=this.GetComponenteFoco;a.AplicarParametrosDeEntrada=this.AplicarParametrosDeEntrada;a.InicializarListado=this.InicializarListado;a.SeleccionarItemIndividual=this.SeleccionarItemIndividual;a.EditarRegistro=this.EditarRegistro;a.onFilterTextoBlur=this.onFilterTextoBlur;a.onFilterTextoSpecialKey=this.onFilterTextoSpecialKey;a.AplicarConfiguracionDeSeguridad=this.AplicarConfiguracionDeSeguridad;a.AgregarFiltro=this.AgregarFiltro;a.LimpiarFiltros=this.LimpiarFiltros;a.CrearStoreGrilla=this.CrearStoreGrilla;a.CargarFiltrosPreseleccionados=this.CargarFiltrosPreseleccionados;a.onGenerarListadoExcel=this.onGenerarListadoExcel;a.onGenerarListadoPdf=this.onGenerarListadoPdf},onGenerarListadoPdf:function(){var b=0;var a={},c="";for(b=0;b<this.filtros.length;b++){this.filtros[b].AgregarParametros(a)}for(property in a){c+="&"+property+"="+a[property]}window.open(this.params.formularioController+"?f=GenerarListadoPdf"+c,"Descargar")},onGenerarListadoExcel:function(){var b=0;var a={},c="";for(b=0;b<this.filtros.length;b++){this.filtros[b].AgregarParametros(a)}for(property in a){c+="&"+property+"="+a[property]}window.location=this.params.formularioController+"?f=GenerarListadoExcel"+c},onBtnAceptarClick:function(){var a=this.getView().down("grid").getStore();var b=Array();a.each(function(d,c){if(d.get("seleccion")==true){b.push(d)}});this.SetDatoSalida("itemsSeleccionados",b);this.SetDatoSalida("accion",AccionRetorno.Guardar);this.IntentarCerrarVentanaContenedora()},onBtnCancelarClick:function(){this.SetDatoSalida("itemsSeleccionados",[]);this.IntentarCerrarVentanaContenedora()},onRender:function(){this.InicializarListado()},onBtnBuscarClick:function(){this.RefrescarGrilla()},onEditarRegistroGrilla:function(b,d,a){var c=b.getStore().getAt(d);this.EditarRegistro(c)},onBtnNuevoClick:function(){var b=this;var c=Ext.create(this.params.nuevaEntidad,{});c.paramsEntrada=b.GetOnNuevoParamsEntrada(b.getView().paramsEntrada);var a=c.getController().GetComponenteFoco();var d=Ext.create("Ext.window.Window",{title:c.controller.params.nombreEntidad+": Crear",height:c.controller.params.altoVentana,width:c.controller.params.anchoVentana,modal:this.params.ventanaModal,maximizable:this.params.ventanaMaximizable,maximized:this.params.ventanaMaximized,collapsible:!this.params.ventanaModal,resizable:false,layout:"fit",defaultFocus:a,listeners:{close:function(){if(b.getView()!=null){b.AgregarItemsSeleccionados(c.datosRetorno,function(){b.RefrescarGrilla();b.RefrescarFiltros()})}this.remove(c)}}});d.add(c);d.show()},onBorrarRegistroGrilla:function(b,d,a){var c=this;Ext.MessageBox.confirm("Borrar","Esta seguro de que desea borrar el registro?",function(e){if(e==="yes"){b.getStore().getAt(d).erase({success:function(){c.RefrescarGrilla();c.RefrescarFiltros()}})}})},onBtnRecargarListadoClick:function(){this.RefrescarGrilla()},onListadoGrillaCellDblClick:function(c,e,b,a,d){this.SeleccionarItemIndividual(c.getRecord(d))},onBtnLimpiarFiltrosClick:function(){this.LimpiarFiltros()},AgregarFiltro:function(a){this.filtros.push(a)},SeleccionarItemIndividual:function(b){var a=Array();if(this.params.modoEjecucion==ModoEjecucionListado.SeleccionIndividual){a.push(b);this.SetDatoSalida("itemsSeleccionados",a);this.SetDatoSalida("accion",AccionRetorno.Guardar);this.IntentarCerrarVentanaContenedora()}else{this.EditarRegistro(b)}},EditarRegistro:function(b){if(this.permisos.verRegistro){var c=this,a;var d=Ext.create(this.params.editarEntidad,{});d.paramsEntrada=c.GetOnEditarParamsEntrada(b,c.getView().paramsEntrada);a=d.getController().GetComponenteFoco();var e=Ext.create("Ext.window.Window",{title:d.controller.params.nombreEntidad+": Editar",height:d.controller.params.altoVentana,width:d.controller.params.anchoVentana,modal:this.params.ventanaModal,maximizable:this.params.ventanaMaximizable,maximized:this.params.ventanaMaximized,collapsible:!this.params.ventanaModal,resizable:false,defaultFocus:a,layout:"fit",listeners:{close:function(){this.remove(d);if(c.getView()!=null){c.RefrescarGrilla();c.RefrescarFiltros()}}}});e.add(d);e.show()}},GetComponenteFoco:function(){return this.getView().down("button[name='btnNuevo']")},AgregarItemsSeleccionados:function(a,d){var c=this.getView().paramsEntrada;if(a.itemsSeleccionados!=null){for(var b=0;b<a.itemsSeleccionados.length;b++){this.GuardarItemSeleccionado(a.itemsSeleccionados[b],c)}}d()},ConfigurarModoVista:function(){var a;this.getView().down("button[name='btnCancelar']").hide();this.getView().down("button[name='btnAceptar']").hide();a=this.getView().down("checkcolumn[name='colSeleccion']");if(a!=null){a.hide()}a=this.getView().down("actioncolumn[name='colEditar']");if(a!=null){a.hide()}},ConfigurarModoSeleccion:function(){this.getView().down("button[name='btnExportar']").hide();ctl=this.getView().down("actioncolumn[name='colEditar']");if(ctl!=null){ctl.hide()}},ConfigurarModoSeleccionIndividual:function(){this.getView().down("button[name='btnCancelar']").hide();this.getView().down("button[name='btnAceptar']").hide();ctl=this.getView().down("checkcolumn[name='colSeleccion']");if(ctl!=null){ctl.hide()}},RefrescarGrilla:function(c){var b=0;var a={};for(b=0;b<this.filtros.length;b++){this.filtros[b].AgregarParametros(a)}this.getView().down("grid").store.proxy.extraParams=a;this.getView().down("grid").store.load()},RefrescarFiltros:function(){var a=0;for(a=0;a<this.filtros.length;a++){this.filtros[a].Refrescar()}},LimpiarFiltros:function(){var a=0;for(a=0;a<this.filtros.length;a++){this.filtros[a].Limpiar()}},CrearStoreGrilla:function(){var b=Ext.create(this.params.storeGrilla,{autoDestroy:true});var c=this.getView().down("grid");var a=this.getView().down("pagingtoolbar");c.reconfigure(b);if(a!=null){a.bindStore(b)}},InicializarListado:function(){this.AplicarParametrosDeEntrada(this.getView().paramsEntrada,this.params);this.CrearStoreGrilla();this.SetupFiltros();this.ConfigurarPantalla();this.RefrescarGrilla()},AplicarParametrosDeEntrada:function(b,a){if(b.modoEjecucion!=null){a.modoEjecucion=b.modoEjecucion}if(b.verColEditar!=null){a.verColEditar=b.verColEditar}if(b.verColBorrar!=null){a.verColBorrar=b.verColBorrar}},ConfigurarPantalla:function(){switch(this.params.modoEjecucion){case ModoEjecucionListado.SeleccionIndividual:this.ConfigurarModoSeleccionIndividual();break;case ModoEjecucionListado.Seleccion:this.ConfigurarModoSeleccion();break;default:this.ConfigurarModoVista();break}if(!this.params.verColEditar){ctl=this.getView().down("checkcolumn[name='colEditar']");if(ctl!=null){ctl.hide()}}if(!this.params.verColBorrar){ctl=this.getView().down("checkcolumn[name='colBorrar']");if(ctl!=null){ctl.hide()}}this.AplicarConfiguracionDeSeguridad();this.CargarFiltrosPreseleccionados()},CargarFiltrosPreseleccionados:function(){var b=0,a=0;var c=this.getView().paramsEntrada;if(c.filtrosPreseleccionados!=null){for(b=0;b<this.filtros.length;b++){for(a=0;a<c.filtrosPreseleccionados.length;a++){if(this.filtros[b].Nombre==c.filtrosPreseleccionados[a].nombre){this.filtros[b].PreSeleccionar(c.filtrosPreseleccionados[a].params)}}}}},AplicarConfiguracionDeSeguridad:function(){if(this.getView().down("button[name='btnNuevo']")!=null){this.getView().down("button[name='btnNuevo']").setDisabled(!this.permisos.crear)}if(!this.permisos.borrar){ctl=this.getView().down("checkcolumn[name='colBorrar']");if(ctl!=null){ctl.hide()}}if(!this.permisos.verRegistro){this.onEditarRegistroGrilla=function(){}}},IntentarCerrarVentanaContenedora:function(){var b=this.getView();var a=b.up("window");if(a!=null){a.close()}},SetDatoSalida:function(b,a){this.getView().datosRetorno[b]=a},GuardarItemSeleccionado:function(a,b){},};