var FormularioControllerBase={InyectarDependencia:function(a,b,c){Ext.apply(a,{permisos:null,params:{modeloEntidad:b,nombreEntidad:"",anchoVentana:0,altoVentana:0},ctl:{},registro:null,detalleModificado:false});Ext.apply(a.getView(),{paramsEntrada:{permisos:null,modeloId:null},datosRetorno:{}});a.permisos=sesionUsuario.GetPermiso(c);a.esNuevo=false;ControllerBase.InyectarDependencia(a);this.semaforo=new Semaforo();a.semaforo=this.semaforo;a.onRender=this.onRender;a.onBtnBorrarClick=this.onBtnBorrarClick;a.onBtnGuardarClick=this.onBtnGuardarClick;a.IntentarCerrarVentanaContenedora=this.IntentarCerrarVentanaContenedora;a.ConfigurarPantalla=this.ConfigurarPantalla;a.GetComponenteFoco=this.GetComponenteFoco;a.SetDetalleModificado=this.SetDetalleModificado;a.ChequearValorAsinc=this.ChequearValorAsinc;a.AplicarConfiguracionDeSeguridad=this.AplicarConfiguracionDeSeguridad;a.RefrescarGrilla=this.RefrescarGrilla;a.RecargarFormulario=this.RecargarFormulario;a.SetearParametrosFormulario(a);a.CargarComponentes()},onRender:function(a){this.ConfigurarPantalla()},onBtnBorrarClick:function(b,c,a){var b=this;Ext.MessageBox.confirm("Borrar","Esta seguro de que desea borrar el registro?",function(d){if(d==="yes"){b.ObtenerRegistroDeFormulario().erase({success:function(e,f){b.IntentarCerrarVentanaContenedora()},failure:function(e,f){Ext.Msg.alert("Error",f.request.getScope().reader.rawData.message)}})}})},onBtnGuardarClick:function(d,f,b){var c=this.getView();var a=this;var g;if(c.isValid()){g=a.ObtenerRegistroDeFormulario();if(g!=null){if(g.dirty||this.detalleModificado){g.save({success:function(e,h){a.IntentarCerrarVentanaContenedora()},failure:function(e,h){Ext.Msg.alert("Error",h.request.getScope().reader.rawData.message)}})}else{a.IntentarCerrarVentanaContenedora()}}}},SetDetalleModificado:function(){this.detalleModificado=true},GetComponenteFoco:function(){return this.getView().down(this.GetElementoFoco())},ConfigurarPantalla:function(){var b,a,d=this;var c=this.getView();if(c.paramsEntrada.modeloId==null){b=Ext.create(this.params.modeloEntidad,{});d.esNuevo=true;d.CargarRegistroEnFormulario(b,d.esNuevo);c.down("button[name='btnBorrar']").disable();a=false}else{b=Ext.create(this.params.modeloEntidad,{id:c.paramsEntrada.modeloId});b.load({success:function(){d.CargarRegistroEnFormulario(b,false)}});a=true}this.AplicarConfiguracionDeSeguridad();return a},AplicarConfiguracionDeSeguridad:function(){var b=this.getView();var c=this.getView().down("button[name='btnGuardar']");var a=this.getView().down("button[name='btnBorrar']");if(b.paramsEntrada.modeloId!=null){c.setDisabled(!this.permisos.modificar);a.setDisabled(!this.permisos.borrar)}},IntentarCerrarVentanaContenedora:function(){var b=this.getView().up("window");var a=Ext.ComponentQuery.query("tabpanel[name='panel-central']")[0];if(b!=null){b.close()}else{Ext.Msg.alert("Aceptar","Operacion realizada con exito");a.remove(this.getView())}},RecargarFormulario:function(){var a=this;if(this.params.registro!=null){this.params.registro.load({success:function(b,c){a.CargarRegistroEnFormulario(a.params.registro,false)}})}},RefrescarGrilla:function(){}};