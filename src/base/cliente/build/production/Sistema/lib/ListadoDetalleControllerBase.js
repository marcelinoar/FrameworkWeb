var ListadoDetalleControllerBase={InyectarDependencia:function(a,b){if(b==null){console.log("ListadoDetalleControllerbase::InyectarDependencia (). Falta parametro")}Ext.apply(a,{permisos:null,store_params:{},ctl:{}});Ext.apply(a.getView(),{paramsEntrada:{modoEjecucion:null,verColEditar:null,verColBorrar:null},datosRetorno:{itemsSeleccionados:[]}});a.permisos=sesionUsuario.GetPermiso(b);ControllerBase.InyectarDependencia(a);a.onEditarRegistroGrilla=this.onEditarRegistroGrilla;a.onBorrarRegistroGrilla=this.onBorrarRegistroGrilla;a.onListadoGrillaCellDblClick=this.onListadoGrillaCellDblClick;a.onBtnNuevoClick=this.onBtnNuevoClick;a.onGrillaAfterRender=this.onGrillaAfterRender;a.onBtnRecargarListadoClick=this.onBtnRecargarListadoClick;a.SetDatoSalida=this.SetDatoSalida;a.GetComponenteFoco=this.GetComponenteFoco;a.AgregarItemsSeleccionados=this.AgregarItemsSeleccionados;a.GuardarItemsSeleccionados=this.GuardarItemsSeleccionados;a.ActualizarRegistro=this.ActualizarRegistro;a.CrearRegistro=this.CrearRegistro;a.BorrarRegistro=this.BorrarRegistro;a.ConfigurarPantalla=this.ConfigurarPantalla;a.RecargarListado=this.RecargarListado;a.ConfigurarListado=this.ConfigurarListado;a.setStoreDetalle=this.setStoreDetalle;a.onRetornoEditor=this.onRetornoEditor;a.onRetornoBorrarRegistroGrilla=this.onRetornoBorrarRegistroGrilla;a.EditarRegistro=this.EditarRegistro},onEditarRegistroGrilla:function(b,d,a){var c=b.getStore().getAt(d);this.EditarRegistro(c)},onBtnNuevoClick:function(){var b=this;var c=Ext.create(this.params.formularioCreacion,{});c.paramsEntrada=b.GetOnNuevoParamsEntrada(b.getView().paramsEntrada);if(c.getController().RefrescarGrilla!=undefined){c.getController().RefrescarGrilla()}var a=c.getController().GetComponenteFoco();var d=Ext.create("Ext.window.Window",{title:this.params.tituloFormularioCreacion,height:c.controller.params.altoVentana,width:c.controller.params.anchoVentana,modal:this.params.ventanaModal,maximizable:this.params.ventanaMaximizable,maximized:this.params.ventanaMaximized,collapsible:!this.params.ventanaModal,resizable:false,layout:"fit",defaultFocus:a,listeners:{close:function(){b.AgregarItemsSeleccionados(c.datosRetorno);b.RecargarListado()}}});d.add(c);d.show()},onBorrarRegistroGrilla:function(b,d,a){var c=this;Ext.MessageBox.confirm("Borrar","Esta seguro de que desea borrar el registro?",function(e){if(e==="yes"){c.BorrarRegistro(b.getStore(),b.getStore().getAt(d));c.onRetornoBorrarRegistroGrilla()}})},onBtnRecargarListadoClick:function(){this.RecargarListado()},onGrillaAfterRender:function(){this.ConfigurarPantalla()},onListadoGrillaCellDblClick:function(c,e,b,a,d){if(this.params.formularioEdicion!=""){this.EditarRegistro(c.getRecord(d))}},ConfigurarListado:function(a,b){this["setModificado"]=a;this.params.perfilDeacceso=b},setStoreDetalle:function(a){this.getView().down("grid").reconfigure(a)},EditarRegistro:function(b){var c=this,a;var d=Ext.create(this.params.formularioEdicion,{});d.paramsEntrada=c.GetOnEditarParamsEntrada(b,c.getView().paramsEntrada);d.paramsEntrada.permisos=this.permisos;a=d.getController().GetComponenteFoco();var e=Ext.create("Ext.window.Window",{title:this.params.tituloFormularioEdicion,height:d.controller.params.altoVentana,width:d.controller.params.anchoVentana,modal:this.params.ventanaModal,maximizable:this.params.ventanaMaximizable,maximized:this.params.ventanaMaximized,collapsible:!this.params.ventanaModal,resizable:false,defaultFocus:a,layout:"fit",listeners:{close:function(){c.AgregarItemsSeleccionados(d.datosRetorno);c.RecargarListado()}}});e.add(d);e.show()},RecargarListado:function(){var a=this.getView().down("grid").store;a.each(function(b){if(b.proxy.alternateClassName!="Ext.data.MemoryProxy"){b.load()}})},ConfigurarPantalla:function(){var a;if(!this.params.verColEditar){a=this.getView().down("actioncolumn[name='colEditar']");if(a!=null){a.hide()}}if(!this.params.verColBorrar){a=this.getView().down("actioncolumn[name='colBorrar']");if(a!=null){a.hide()}}},GetComponenteFoco:function(){return this.getView().down("button")},AgregarItemsSeleccionados:function(b){var a;if(this.getView()!=null){a=this.getView().down("grid").store;switch(b.accion){case AccionRetorno.Guardar:this.GuardarItemsSeleccionados(a,b.itemsSeleccionados);break;case AccionRetorno.Actualizar:this.ActualizarRegistro(a,b.modelo);break;case AccionRetorno.Crear:this.CrearRegistro(a,b.modelo);break;case AccionRetorno.Borrar:this.BorrarRegistro(a,b.modelo);break}this.onRetornoEditor()}},GuardarItemsSeleccionados:function(a,c){var b;var d;if(c!=null){this.setModificado();for(var b=0;b<c.length;b++){a.add(c[b])}}},ActualizarRegistro:function(a,b){this.setModificado()},CrearRegistro:function(a,b){this.setModificado();a.add(b)},BorrarRegistro:function(a,b){this.setModificado();a.remove(b)},SetDatoSalida:function(b,a){this.getView().datosRetorno[b]=a},SetPermisos:function(a){this.params.permisos=a},onRetornoEditor:function(){},onRetornoBorrarRegistroGrilla:function(){}};